{"version":3,"file":"networkUtils.js","sources":["../../src/networkUtils.ts"],"sourcesContent":["import { logger } from '@sentry/core';\nimport type { Logger } from '@sentry/core';\nimport { DEBUG_BUILD } from './debug-build';\nimport type { NetworkMetaWarning } from './types';\n\n/**\n * Serializes FormData.\n *\n * This is a bit simplified, but gives us a decent estimate.\n * This converts e.g. { name: 'Anne Smith', age: 13 } to 'name=Anne+Smith&age=13'.\n *\n */\nexport function serializeFormData(formData: FormData): string {\n  // @ts-expect-error passing FormData to URLSearchParams actually works\n  return new URLSearchParams(formData).toString();\n}\n\n/** Get the string representation of a body. */\nexport function getBodyString(body: unknown, _logger: Logger = logger): [string | undefined, NetworkMetaWarning?] {\n  try {\n    if (typeof body === 'string') {\n      return [body];\n    }\n\n    if (body instanceof URLSearchParams) {\n      return [body.toString()];\n    }\n\n    if (body instanceof FormData) {\n      return [serializeFormData(body)];\n    }\n\n    if (!body) {\n      return [undefined];\n    }\n  } catch (error) {\n    DEBUG_BUILD && _logger.error(error, 'Failed to serialize body', body);\n    return [undefined, 'BODY_PARSE_ERROR'];\n  }\n\n  DEBUG_BUILD && _logger.info('Skipping network body because of body type', body);\n\n  return [undefined, 'UNPARSEABLE_BODY_TYPE'];\n}\n\n/**\n * Parses the fetch arguments to extract the request payload.\n *\n * We only support getting the body from the fetch options.\n */\nexport function getFetchRequestArgBody(fetchArgs: unknown[] = []): RequestInit['body'] | undefined {\n  if (fetchArgs.length !== 2 || typeof fetchArgs[1] !== 'object') {\n    return undefined;\n  }\n\n  return (fetchArgs[1] as RequestInit).body;\n}\n"],"names":["logger","DEBUG_BUILD"],"mappings":";;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,iBAAiB,CAAC,QAAQ,EAAoB;AAC9D;AACA,EAAE,OAAO,IAAI,eAAe,CAAC,QAAQ,CAAC,CAAC,QAAQ,EAAE;AACjD;;AAEA;AACO,SAAS,aAAa,CAAC,IAAI,EAAW,OAAO,GAAWA,WAAM,EAA6C;AAClH,EAAE,IAAI;AACN,IAAI,IAAI,OAAO,IAAK,KAAI,QAAQ,EAAE;AAClC,MAAM,OAAO,CAAC,IAAI,CAAC;AACnB;;AAEA,IAAI,IAAI,IAAK,YAAW,eAAe,EAAE;AACzC,MAAM,OAAO,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC;AAC9B;;AAEA,IAAI,IAAI,IAAK,YAAW,QAAQ,EAAE;AAClC,MAAM,OAAO,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;AACtC;;AAEA,IAAI,IAAI,CAAC,IAAI,EAAE;AACf,MAAM,OAAO,CAAC,SAAS,CAAC;AACxB;AACA,GAAI,CAAA,OAAO,KAAK,EAAE;AAClB,IAAIC,sBAAA,IAAe,OAAO,CAAC,KAAK,CAAC,KAAK,EAAE,0BAA0B,EAAE,IAAI,CAAC;AACzE,IAAI,OAAO,CAAC,SAAS,EAAE,kBAAkB,CAAC;AAC1C;;AAEA,EAAEA,sBAAA,IAAe,OAAO,CAAC,IAAI,CAAC,4CAA4C,EAAE,IAAI,CAAC;;AAEjF,EAAE,OAAO,CAAC,SAAS,EAAE,uBAAuB,CAAC;AAC7C;;AAEA;AACA;AACA;AACA;AACA;AACO,SAAS,sBAAsB,CAAC,SAAS,GAAc,EAAE,EAAmC;AACnG,EAAE,IAAI,SAAS,CAAC,WAAW,CAAA,IAAK,OAAO,SAAS,CAAC,CAAC,CAAE,KAAI,QAAQ,EAAE;AAClE,IAAI,OAAO,SAAS;AACpB;;AAEA,EAAE,OAAO,CAAC,SAAS,CAAC,CAAC,CAAE,GAAgB,IAAI;AAC3C;;;;;;"}